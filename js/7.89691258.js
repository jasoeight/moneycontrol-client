(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"+g00":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n("yT7P"),a=n("L2JU"),i=(Object(o["a"])({},Object(a["d"])("users",{})),Object(a["b"])("users",["saveUser","fetchAllUsers","deleteUser"]))},"7YFy":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("layout-main",{attrs:{row:"",wrap:""}},[n("v-flex",{staticClass:"my-3",attrs:{xs12:""}},[n("user-table",{ref:"table",on:{edit:t.onEdit,add:t.onAdd}})],1),t.showForm?n("v-flex",{attrs:{xs12:""}},[n("user-form",{ref:"form",on:{cancel:t.onCancel,stored:t.onStored},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1):t._e()],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[n("v-spacer"),n("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(e){t.$emit("add")}}},[n("v-icon",[t._v("add")]),t._v(" Add\n        ")],1)],1),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.items,pagination:t.pagination,"total-items":t.totalItems,loading:t.loading},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[n("td",[t._v(t._s(e.item.name))]),n("td",[t._v(t._s(e.item.email))]),n("td",[t._v(t._s(e.item.all))]),n("td",{staticClass:"justify-center layout px-0"},[n("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(n){t.onEdit(e.item)}}},[n("v-icon",{attrs:{color:"teal"}},[t._v("edit")])],1),n("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(n){t.onDelete(e.item)}}},[n("v-icon",{attrs:{color:"pink"}},[t._v("delete")])],1)],1)]}}])},[n("template",{slot:"no-data"},[n("v-alert",{attrs:{value:!t.loading,color:"error",icon:"warning"}},[t._v("\n                Sorry, nothing to display here\n            ")])],1)],2)],1)},s=[],r=n("yT7P"),l=n("+g00"),c=n("lfAH"),d={data:function(){return{totalItems:0,items:[],loading:!0,pagination:{sortBy:"email",descending:!0,page:1,rowsPerPage:10},headers:[{text:"Name",sortable:!0,value:"name"},{text:"Email",sortable:!0,value:"email"},{text:"All",sortable:!0,value:"all"},{text:"Actions",sortable:!1,value:"_id"}]}},watch:{pagination:{handler:"load",deep:!0}},methods:Object(r["a"])({},l["a"],c["a"],{load:function(){var t=this;this.loading=!0;var e=this.pagination,n=e.sortBy,o=e.descending,a=e.page,i=e.rowsPerPage;this.fetchAllUsers({sortBy:n,sortDir:o?"desc":"asc",page:a,limit:i}).then(function(e){var n=e.data;t.loadFinished(n.rows,n.count)}).catch(function(){t.loadFinished([],0)})},loadFinished:function(t,e){this.items=t,this.totalItems=e,this.loading=!1},onEdit:function(t){this.$emit("edit",t)},onDelete:function(t){var e=this,n=t._id;this.hasNoTransactions(n).then(function(){e.deleteUser(n).then(e.load)}).catch(function(){e.$dialog.alert("Cannot remove user because of existing references in some transactions.",{okText:"Ok"})})},hasNoTransactions:function(t){var e=this;return new Promise(function(n,o){e.fetchAllTransactions({search:{userId:t},limit:1,noPopulate:1}).then(function(t){var e=t.data;0!==e.count?o():n()}).catch(function(t){o()})})}})},u=d,m=n("KHd+"),f=Object(m["a"])(u,i,s,!1,null,null,null),h=f.exports,v=n("BkRI"),p=n.n(v),g={components:{UserTable:h,UserForm:function(){return n.e(3).then(n.bind(null,"k8wK"))}},data:function(){return{showForm:!1,form:{}}},methods:{onAdd:function(){this.form={},this.showForm=!0},onCancel:function(){this.showForm=!1,this.form={}},onEdit:function(t){t=p()(t),t.password="",this.form=t,this.showForm=!0},onStored:function(){this.showForm=!1,this.form={},this.$refs.table.load()}}},b=g,w=Object(m["a"])(b,o,a,!1,null,null,null);e["default"]=w.exports}}]);
//# sourceMappingURL=7.89691258.js.map